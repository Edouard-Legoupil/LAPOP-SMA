---
title: "Trust_Index.rmd"
author: "Jorge L. Perez"
date: "31 October 2015"
output: html_document
---

The following is a proposal for a Trust in Government Index, for which the following variables were considered to be the most relevant in determining the citizens' trust in all civic, public, political and governmental structures:

* `b1`: Courts Guarantee a Fair Trial (1=Not at all, 7=A lot)
* `b2`: Respect for Political Institutions (1=Not at all, 7=A lot)
* `b3`: Respect for Basic Rights (1=Not at all, 7=A lot)
* `b4`: Pride in Political System (1=Not at all, 7=A lot)
* `b6`: People Should Support the Political System (1=Not at all, 7=A lot)
* `b10a`: Trust in Judicial System (1=Not at all, 7=A lot)
* `b11`: Trust in the National Electoral Institution (1=Not at all, 7=A lot)
* `b12`: Trust in Armed Forces (1=Not at all, 7=A lot)
* `b13`: Trust in National Legislature (1=Not at all, 7=A lot)
* `b18`: Trust in National Police (1=Not at all, 7=A lot)
* `b21`: Trust in Political Parties (1=Not at all, 7=A lot)
* `b21a`: Trust in Executive (1=Not at all, 7=A lot)
* `b32`: Trust in Local Government (1=Not at all, 7=A lot) 
* `b37`: Trust in the Media (1=Not at all, 7=A lot)
* `b47a`: Trust in Elections (1=Not at all, 7=A lot)
* `b14`: Trust in the Central Government (1=Not at all, 7=A lot)
* `b15`: Trust in the Public Ministry (1=Not at all, 7=A lot)
* `b19`: Trust in Superior Court of Accounts (1=Not at all, 7=A lot)
* `b46`: Trust in National Anticorruption Council (1=Not at all, 7=A lot) 
* `honb51`: Trust in Commission for Human Rights (1=Not at all, 7=A lot)
* `venb11`: Trust in the secret vote in Honduras (1=Not at all, 7=A lot)
* `venhonb51`: Trust that election results reflect the votes issued (1=Not at all, 7=A lot)
* `venhonvb10`: Level of agreement for having international observers at elections (1=Not at all, 7=A lot)
* `epp1`: Political parties represent voters well (1=Not at all, 7=A lot)
* `epp3`: Political parties listen to voters (1=Not at all, 7=A lot)
* `n9`: Evaluation of administration's handling of corruption (1=Not at all, 7=A lot)
* `n11`: Evaluation of administration's handling of citizen security (1=Not at all, 7=A lot) 
* `n15`: Evaluation of administration's handling of economy (1=Not at all, 7=A lot)
* `b3milx`: Armed Forces respect human rights (1=Not at all, 7=A lot) 

Variables measuring the levels of trust in religious institutions, such as the Catholic and the Protestant Churches, were left out of this proposed index, since they do not partake in the structures of government and political and civil affairs - regardless, of their influence in the citizens' daily lives. 

The `set.seed(12345)` command was not included in this index or the wealth index, but it's a good idea. This specifies the starting point for the random number generator used in multiple imputation and ensures that the results of your analysis will be identical every time.

```{r}
library(ggplot2)
#install.packages("mice") # if you don't have it already
library(mice)
library(plyr) # nice for re-formatting data
#install.packages("GGally") # if you don't have it already
library(GGally) # for plot matrices
set.seed(12345) # makes imputation reproducible
```


```{r}
lapop.2014.HND <- read.csv('../2014-HND.csv')
my_data <- lapop.2014.HND[,c('b1','b2','b3','b4','b6','b10a','b11','b12','b13','b18','b21','b21a','b32', 'b37','b47a','b14','b15','b19','b46','honb51','venb11', 'venhonb51', 'venhonvb10','epp1','epp3','n9','n11','n15', 'b3milx')]
```

Firstly, how many missing values do we have here?
```{r}
is.na(my_data[my_data>16]) <- TRUE
nrow(na.omit(my_data))
```
So, with the missing values we have 1,129 rows left

```{r}
sum(is.na(my_data)) / (nrow(my_data)*ncol(my_data))
```
Around 2% of missing variables. Not bad.

```{r}
my_complete <- na.omit(my_data)
pr_complete <- prcomp(my_complete,center=TRUE,scale=FALSE)
plot(pr_complete)
summary(pr_complete)
```

If we don't do any imputation, 39.8% of variance is contained in the first principal component; the others all appear to be much lower.

```{r}
my_imp <- mice(my_data,printFlag = F) 
my_imp
```

None of the variables really stand out as needing a lot of imputation -- `b19` (Trust in the Superior Court of Accounts) is a little higher than others, possibly because some people don't know enough about it to know whether to trust it or not.

```{r}
pr <- lapply(1:5,function(x) prcomp(complete(my_imp,x),scale=FALSE,center=TRUE))
plot(pr[[1]])
summary(pr[[1]])

```

After imputation, things don't change much -- 38.6% of variance is in the first PC.

```{r}
pc1 <- pr[[1]]$x[,1]
pc2 <- pr[[1]]$x[,2]
qplot(pc1,pc2)

```

First indication that things seem to be going well... a cluster is forming between all the variables.

```{r}
all_pc1 <- data.frame(llply(1:5, function(i) pr[[i]]$x[,1]))
names(all_pc1) <- c('imp1','imp2','imp3','imp4','imp5')
ggpairs(all_pc1) + theme_classic()

```

Beautiful distributions, high correlations (probably because not much imputation was required).

```{r}
all_pc1$avg <- rowMeans(all_pc1)
quantile(all_pc1$avg)
colMeans(my_data[all_pc1$avg < quantile(all_pc1$avg)[2],],na.rm=TRUE)
colMeans(my_data[all_pc1$avg > quantile(all_pc1$avg)[4],],na.rm=TRUE)
```

I'm seeing that the higher values are located on the bottom (25%) quantile. To reverse this:

```{r}
all_pc1$norm <- scale(-all_pc1$avg)
colMeans(my_data[all_pc1$norm < quantile(all_pc1$norm)[2],],na.rm=TRUE)
colMeans(my_data[all_pc1$norm > quantile(all_pc1$norm)[4],],na.rm=TRUE)
```
What are we seeing now? In all, I am considering a few things here: we are taking the average value for the responses to each variable. This scale is represented as 1=Not at all, and 7=A lot. Taking a look at the average values on both the lower (25%) quantile, and the higher (25%) quantile for each variable, I am not seeing any strong differences when comparing both quantiles. My intuition tells me that for most of these questions regarding trust in the government, the responses had a tendency to meet somewhere in the middle. However, there is one variable that stands out to me, compared to the others: `b21a`(Trust in Executive), which presents an average value of 2.4 on the lower (25%) quantile, and a an average value of 6.1 on the higher (25%) quantile. A priori this indicates to me that there is a higher level of trust on the Executive, and that the opinions were much stronger on this question than on the others.



```{r}
predict_data <- data.frame(b1=c(1,7),b2=c(1,7),b3=c(1,7),b4=c(1,7),
                           b6=c(1,7),b10a=c(1,7),b11=c(1,7),b12=c(1,7),
                           b13=c(1,7),b18=c(1,7),b21=c(1,7),b21a=c(1,7),
                           b32=c(1,7),b37=c(1,7),b47a=c(1,7),b14=c(1,7),
                           b15=c(1,7), b19=c(1,7), b46=c(1,7), honb51=c(1,7), venb11=c(1,7), venhonvb10=c(1,7), epp1=c(1,7), epp3=c(1,7), n9=c(1,7), n11=c(1,7), n15=c(1,7), b3milx=c(1,7))
minmax <- rowMeans(sapply(1:5, function(i) predict(pr[[i]],predict_data)[,1]))
minmax <- (minmax-mean(all_pc1$avg)) / sd(all_pc1$avg)

predict_data2 <- data.frame(diag(28)+1)
names(predict_data2) <- names(my_data)
scores <- rowMeans(sapply(1:5, function(i) predict(pr[[i]],predict_data2)[,1]))
scores <- (scores-mean(all_pc1$avg)) / sd(all_pc1$avg)
diff <- data.frame(d=(scores - minmax[1]),n=names(predict_data))
ggplot(diff,aes(x=n,y=d)) +
  geom_bar(stat='identity',fill='skyblue') +
  coord_flip() +
  theme_classic() +
  theme(text=element_text(size=20),
        axis.title.y=element_blank(),
        axis.title.x=element_blank())
```

**For future reference!**
*As pointed out by Craig, the code listed above ran into the following potential issues:*
- The first value in `minmax` (ostensibly the minimum) is higher than the second (maximum). This could be an indication that `predict_data` wasn't set up correctly, or that high values of your index correspond to low trust, rather than high. The first row in `predict_data` should be the answers that a person with the minimum possible level of trust in government would have given; the second should be the answers showing a maximum level of trust.
- If you look at `quantile(all_pc1$norm)`, you'll see that the minimum value is slightly higher than the lower value in `minmax`, and the maximum slightly lower than the higher value in `minmax`. This is good.
- When you make the bar plot, you'll notice that all of the values are negative. This is because `predict_data2` is full of 1's and 2's -- that means you're starting with a baseline of no trust (1) and moving up to a tiny bit of trust (2). The resulting scores (stored in the variable `scores`) are all close to the maximum value of your index (which is stored in `minmax[1]`). Since you're subtracting the maximum from these perturbed scores (in line 110), everything comes out negative, which is sort of funny. It also tells us that higher values of the index mean less trust, which isn't very intuitive.

*The recommendation was, therefore, to replace the abovementioned code with the following:*

```{r}
all_pc1$norm <- -scale(all_pc1$avg) # reversed; now low scores mean low trust
predict_data <- data.frame(b1=c(1,7),b2=c(1,7),b3=c(1,7),b4=c(1,7),
                           b6=c(1,7),b10a=c(1,7),b11=c(1,7),b12=c(1,7),
                           b13=c(1,7),b18=c(1,7),b21=c(1,7),b21a=c(1,7),
                           b32=c(1,7),b37=c(1,7),b47a=c(1,7),b14=c(1,7),
                           b15=c(1,7), b19=c(1,7), b46=c(1,7), honb51=c(1,7), 
                           venb11=c(1,7), venhonvb10=c(1,7), epp1=c(1,7), 
                           epp3=c(1,7), n9=c(1,7), n11=c(1,7), n15=c(1,7), 
                           b3milx=c(1,7))
minmax <- rowMeans(sapply(1:5, function(i) predict(pr[[i]],predict_data)[,1]))
minmax <- -(minmax - mean(all_pc1$avg)) / sd(all_pc1$avg) # make sure to reverse here also

predict_data2 <- data.frame(diag(28)+1)
names(predict_data2) <- names(my_data)
scores <- rowMeans(sapply(1:5, function(i) predict(pr[[i]],predict_data2)[,1]))
scores <- -(scores-mean(all_pc1$avg)) / sd(all_pc1$avg) # make sure to reverse here as well
diff <- data.frame(d=(scores - minmax[1]),n=names(predict_data))
ggplot(diff,aes(x=n,y=d)) +
  geom_bar(stat='identity',fill='skyblue') +
  coord_flip() +
  theme_classic() +
  theme(text=element_text(size=20),
        axis.title.y=element_blank(),
        axis.title.x=element_blank())
```

Now everything seems to be pointing the right direction. All variables seem to have a big influence on the Trust Index, except for `b1` , `b2` , `b6` and `b37`.

As suggested, by the Authoritarianism index, we can be more rigorous here by calculating the p-values.

```{r}
lmp <- function (modelobject) {
    if (class(modelobject) != "lm") stop("Not an object of class 'lm' ")
    f <- summary(modelobject)$fstatistic
    p <- pf(f[1],f[2],f[3],lower.tail=F)
    attributes(p) <- NULL
    return(p)
}
sapply(c('b1','b2','b3', 'b4','b6','b10a','b11','b12','b13',
                             'b18','b21','b21a','b32', 'b37','b47a','b14','b15','b19','b46', 'honb51', 'venb11', 'venhonvb10', 'epp1', 'epp3', 'n9', 'n11', 'n15', 'b3milx'),
       function(x) lmp(lm(all_pc1$norm ~ my_data[,x])))

```

Beautiful!

```{r}

b37 <- data.frame(q=my_data$b37,w=all_pc1$norm)
b37 <- na.omit(b37)
my_lm <- lm(data=b37, q ~ w)
summary(my_lm)
ggplot(b37,aes(x=w,y=q)) +
  geom_jitter(color='tomato3',size=5,alpha=0.2) +
  theme_classic() +
  geom_smooth(method='lm',size=2,color='royalblue') +
  annotate('text',label=paste("R-sq:",round(summary(my_lm)$r.squared,2)),  
           size=10,x=-0.5,y=2.5,hjust=0,vjust=0,color='royalblue') +
  ylab('b37') +
  xlab('Composite index') +
  theme(text=element_text(size=20))
```

My original intention was to remove the variables: `b1` , `b2` , `b6` and `b37` , as they were the least influential in this proposed index. However, when we calculated the p-values for all of these variables, we concluded that they were still pretty significant. The proposed index remains as is.

**Now let's see how we can apply the same methodology for the Trust Index for both Guatemala and El Salvador!**

Next up: El Salvador.

```{r}
library(ggplot2)
#install.packages("mice") # if you don't have it already
library(mice)
library(plyr) # nice for re-formatting data
#install.packages("GGally") # if you don't have it already
library(GGally) # for plot matrices
set.seed(12345) # makes imputation reproducible
```

Already, there are a few variables that are not shared between the data for Honduras and El Salvador.
```{r}
my_data <- lapop.2014.SLV[,c('b1','b2','b3','b4','b6','b10a','b11','b12','b13','b18','b21','b21a','b32', 'b47a','esb48','n9','n11','n15','epp1','epp3','b3milx','pr4','epn3a','epn3b','epn3c')]
```
* `b1`: Courts Guarantee Fair Trial (1=Not at all, 7=A lot)
* `b2`: Respect for Political Institutions (1=Not at all, 7=A lot)
* `b3`: Respect for Basic Rights (1=Not at all, 7=A lot)
* `b4`: Pride in Political System (1=Not at all, 7=A lot)
* `b6`: People Should Support the Political System (1=Not at all, 7=A lot)
* `b10a`: Trust in Judicial System (1=Not at all, 7=A lot)
* `b11`: Trust in the National Electoral Institution (1=Not at all, 7=A lot)
* `b12`: Trust in Armed Forces (1=Not at all, 7=A lot)
* `b13`: Trust in the National Legislature (1=Not at all, 7=A lot)
* `b18`: Trust in National Police (1=Not at all, 7=A lot)
* `b21`: Trust in Political Parties (1=Not at all, 7=A lot)
* `b21a`: Trust in Executive (1=Not at all, 7=A lot)
* `b32`: Trust in Local Government (1=Not at all, 7=A lot)
* `b47a`: Trust in Elections (1=Not at all, 7=A lot)
* `esb48`: Trust in the Institute of Access to Public Information (1=Not at all, 7=A lot)
* `n9`: Evaluation of Administration's Handling of Corruption (1=Not at all, 7=A lot)
* `n11`: Evaluation of Administration's Handling of Citizen Security (1=Not at all, 7=A lot)
* `n15`: Evaluation of Administration's Handling of Economy (1=Not at all, 7=A lot)
* `epp1`: Political Parties Represent Voters Well (1=Not at all, 7=A lot)
* `epp3`: Political Parties Listen to Voters (1=Not at all, 7=A lot)
* `b3milx`: Armed Forces Respect Human Rights (1=Not at all, 7=A lot)
* `pr4`: Government Respects Private Property (1=Not at all, 7=A lot)
* `epn3a`: Central Governement Represents Your Interests (1=Not at all, 7=A lot)
* `epn3b`: Legislative Representative Represents Your Interests (1=Not at all, 7=A lot)
* `epn3c`: Mayor and City Council Represent Your Interests (1=Not at all, 7=A lot)

As is to be expected with a LAPOP study, there are questions that were adapted to reflect the national reality of a country. Here we have examples of a few variables that we did not see for Honduras, but that were selected for this proposed Trust Index for El Salvador:
* `esb48` - which presents an institution particular to El Salvador's civil and political structure
* `epn3a`, `epn3b`, `epn3c` - which reflect confidence on these institutions, and their democratic nature
* `pr4`- reflecting confidence in the government's role in society


```{r}
is.na(my_data[my_data>16]) <- TRUE
nrow(na.omit(my_data))
```
With missing values, we are left with 1,354 rows. Off to a good start!

```{r}
sum(is.na(my_data)) / (nrow(my_data)*ncol(my_data))
```
Around 1% of missing values.

```{r}
my_complete <- na.omit(my_data)
pr_complete <- prcomp(my_complete,center=TRUE,scale=FALSE)
plot(pr_complete)
summary(pr_complete)
```
Without any imputation, 39.7% of my variance is concentrated in my first principle component.

```{r}
my_imp <- mice(my_data,printFlag = F) 
my_imp
```
None of the variables seem to be needing any imputation, with the exception of,perhaps, `esb48`. Again, it is most likely that the Institute of Access to Public Information is not that well-known.

```{r}
pr <- lapply(1:5,function(x) prcomp(complete(my_imp,x),scale=FALSE,center=TRUE))
plot(pr[[1]])
summary(pr[[1]])
```
Following the imputation, not much has changed. 39.5% of variance is concentrated on the first principle component.

```{r}
pc1 <- pr[[1]]$x[,1]
pc2 <- pr[[1]]$x[,2]
qplot(pc1,pc2)
```
This scatterplot is reassuring; much like the one we ran for Honduras, this one too forms a "blob".

```{r}
all_pc1 <- data.frame(llply(1:5, function(i) pr[[i]]$x[,1]))
names(all_pc1) <- c('imp1','imp2','imp3','imp4','imp5')
ggpairs(all_pc1) + theme_classic()
```
Incredible correlations; the lack of needing too much imputation probably helps out here.

```{r}
all_pc1$avg <- rowMeans(all_pc1)
quantile(all_pc1$avg)
colMeans(my_data[all_pc1$avg < quantile(all_pc1$avg)[2],],na.rm=TRUE)
colMeans(my_data[all_pc1$avg > quantile(all_pc1$avg)[4],],na.rm=TRUE)
```
Nothing out of line yet, but comparing the higher (25%) quantile to the lower (25%) quantile, the variables `epn3a`, `epn3b`and `epn3c`have lower values - although, the differences are not significant.

```{r}
all_pc1$norm <- -scale(all_pc1$avg) # reversed; now low scores mean low trust
predict_data <- data.frame(b1=c(1,7),b2=c(1,7),b3=c(1,7),b4=c(1,7),
                           b6=c(1,7),b10a=c(1,7),b11=c(1,7),b12=c(1,7),
                           b13=c(1,7),b18=c(1,7),b21=c(1,7),b21a=c(1,7),
                           b32=c(1,7),b47a=c(1,7),esb48=c(1,7),
                           n9=c(1,7), n11=c(1,7), n15=c(1,7),epp1=c(1,7), 
                           epp3=c(1,7),b3milx=c(1,7), pr4=c(1,7), epn3a=c(1,7), 
                           epn3b=c(1,7),epn3c=c(1,7))
minmax <- rowMeans(sapply(1:5, function(i) predict(pr[[i]],predict_data)[,1]))
minmax <- -(minmax - mean(all_pc1$avg)) / sd(all_pc1$avg) # make sure to reverse here also

predict_data2 <- data.frame(diag(25)+1)
names(predict_data2) <- names(my_data)
scores <- rowMeans(sapply(1:5, function(i) predict(pr[[i]],predict_data2)[,1]))
scores <- -(scores-mean(all_pc1$avg)) / sd(all_pc1$avg) # make sure to reverse here as well
diff <- data.frame(d=(scores - minmax[1]),n=names(predict_data))
ggplot(diff,aes(x=n,y=d)) +
  geom_bar(stat='identity',fill='skyblue') +
  coord_flip() +
  theme_classic() +
  theme(text=element_text(size=20),
        axis.title.y=element_blank(),
        axis.title.x=element_blank())
```

```{r}
lmp <- function (modelobject) {
    if (class(modelobject) != "lm") stop("Not an object of class 'lm' ")
    f <- summary(modelobject)$fstatistic
    p <- pf(f[1],f[2],f[3],lower.tail=F)
    attributes(p) <- NULL
    return(p)
}
sapply(c('b1','b2','b3', 'b4','b6','b10a','b11','b12','b13',
                             'b18','b21','b21a','b32', 'b47a','esb48','n9','n11','n15', 'epp1', 'epp3', 'b3milx', 'pr4', 'epn3a', 'epn3b','epn3c'),
       function(x) lmp(lm(all_pc1$norm ~ my_data[,x])))
```

```{r}
epn3c <- data.frame(q=my_data$epn3c,w=all_pc1$norm)
epn3c <- na.omit(epn3c)
my_lm <- lm(data=epn3c, q ~ w)
summary(my_lm)
ggplot(epn3c,aes(x=w,y=q)) +
  geom_jitter(color='tomato3',size=5,alpha=0.2) +
  theme_classic() +
  geom_smooth(method='lm',size=2,color='royalblue') +
  annotate('text',label=paste("R-sq:",round(summary(my_lm)$r.squared,2)),  
           size=10,x=-0.5,y=2.5,hjust=0,vjust=0,color='royalblue') +
  ylab('epn3c') +
  xlab('Composite index') +
  theme(text=element_text(size=20))
```

```{r}
epn3a <- data.frame(q=my_data$epn3a,w=all_pc1$norm)
epn3a <- na.omit(epn3a)
my_lm <- lm(data=epn3a, q ~ w)
summary(my_lm)
ggplot(epn3a,aes(x=w,y=q)) +
  geom_jitter(color='tomato3',size=5,alpha=0.2) +
  theme_classic() +
  geom_smooth(method='lm',size=2,color='royalblue') +
  annotate('text',label=paste("R-sq:",round(summary(my_lm)$r.squared,2)),  
           size=10,x=-0.5,y=2.5,hjust=0,vjust=0,color='royalblue') +
  ylab('epn3a') +
  xlab('Composite index') +
  theme(text=element_text(size=20))
```

```{r}
my_data2 <- lapop.2014.SLV[,c('b1','b2','b3','b4','b6','b10a','b11','b12','b13','b18','b21','b21a','b32', 'b47a','esb48','n9','n11','n15','epp1','epp3','b3milx','pr4','epn3a')]
```

```{r}
is.na(my_data2[my_data2>16]) <- TRUE
my_complete2 <- na.omit(my_data2)
pr_complete2 <- prcomp(my_complete2,center=TRUE,scale=FALSE)
plot(pr_complete2)
summary(pr_complete2)
```

```{r}
my_imp2 <- mice(my_data2,printFlag = F) 
pr2 <- lapply(1:5,function(x) prcomp(complete(my_imp2,x),scale=FALSE,center=TRUE))
plot(pr2[[1]]) 
summary(pr2[[1]])
```

```{r}
all_pc2 <- data.frame(llply(1:5, function(i) pr2[[i]]$x[,1]))
names(all_pc2) <- c('imp1','imp2','imp3','imp4','imp5')
ggpairs(all_pc2) + theme_classic()
```

```{r}
all_pc2$avg <- rowMeans(all_pc2)
all_pc2$norm <- scale(all_pc2$avg)
colMeans(my_data2[all_pc2$norm < quantile(critics_tol$norm)[2],],na.rm=TRUE)
colMeans(my_data2[all_pc2$norm > quantile(critics_tol$norm)[4],],na.rm=TRUE)
```

```{r}
sapply(c('b1','b2','b3','b4','b10a','b11','b12','b13','b18','b21','b21a','b32','b47a','esb48','n9','n11','n15', 'epp1', 'epp3', 'b3milx', 'pr4', 'epn3a'),
 function(x) lmp(lm(critics_tol$norm ~ my_data[,x])))
```

```{r}
b2 <- data.frame(q=my_data2$b2,w=all_pc2$norm)
b2 <- na.omit(b2)
my_lm <- lm(data=b2, q ~ w)
summary(my_lm)
ggplot(b2,aes(x=w,y=q)) +
  geom_jitter(color='tomato3',size=5,alpha=0.2) +
  theme_classic() +
  geom_smooth(method='lm',size=2,color='royalblue') +
  annotate('text',label=paste("R-sq:",round(summary(my_lm)$r.squared,2)),  
           size=10,x=-0.5,y=2.5,hjust=0,vjust=0,color='royalblue') +
  ylab('b2') +
  xlab('Composite index') +
  theme(text=element_text(size=20)) 
```

```{r}
epn3a <- data.frame(q=my_data2$epn3a,w=all_pc2$norm)
epn3a <- na.omit(epn3a)
my_lm <- lm(data=epn3a, q ~ w)
summary(my_lm)
ggplot(b2,aes(x=w,y=q)) +
  geom_jitter(color='tomato3',size=5,alpha=0.2) +
  theme_classic() +
  geom_smooth(method='lm',size=2,color='royalblue') +
  annotate('text',label=paste("R-sq:",round(summary(my_lm)$r.squared,2)),  
           size=10,x=-0.5,y=2.5,hjust=0,vjust=0,color='royalblue') +
  ylab('epn3a') +
  xlab('Composite index') +
  theme(text=element_text(size=20)) 
```





















































































































































































